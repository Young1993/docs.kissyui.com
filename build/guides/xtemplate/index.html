<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scale=no">
	<title>Guides - KISSY v5.0 Documentation</title>
	<link rel="shortcut icon" href="/5.0/assets/img/favicon.ico">
	<link rel="stylesheet" type="text/css" href="/5.0/assets/css/base.css">
	<link rel="stylesheet" type="text/css" href="/5.0/assets/css/main.css">
	<link rel="stylesheet" type="text/css" href="/5.0/assets/css/github.css"/>
	<script type="text/javascript" src="http://g.tbcdn.cn/kissy/edge/2014.09.05/seed.js" data-config="{combine:true}"></script>
</head>
<body>
	<div class="header">
		<div class="inner">
	<div class="toolbar">
		<a href="/5.0">
			<img class="mini-logo" src="/5.0/assets/img/mini-logo.png">
		</a>
		<ul class="nav clearfix">
			<li class="docs">
				<span>
					Docs
					<b class="caret"></b>
				</span>
				<ul>
					<li><a href="/5.0/guides/">Guides</a></li>
					<li><a href="/5.0/api">Api Docs</a></li>
					<li><a href="/5.0/demos">Demos</a></li>
				</ul>
			</li>
			<li class="more">
				<span>
					More
					<b class="caret"></b>
				</span>
				<ul>
					<li><a href="/5.0/more/faq.html">FAQ</a></li>
					<li><a href="http://gallery.kissyui.com/">Gallery</a></li>
					<li><a href="http://blog.kissyui.com/">KISSY Blog</a></li>
					<li><a href="https://github.com/daxingplay/grunt-kmc/blob/master/README.md">KMC</a></li>
				</ul>
			</li>
			<li class="split"></li>
			<li class="nav-other"><a href="/5.0/quick-start.html">Quick Start</a></li>
			<li class="nav-other"><a href="https://github.com/kissyteam/kissy/blob/master/CONTRIBUTING.md">Contribute</a></li>
			<li class="nav-other"><a href="#">KISSY UP</a></li>
		</ul>
	</div>
	<div class="search">
		
	</div>
</div>
	</div>
	<div class="main">
		<div class="guide">
			<div class="logo-on-top clearfix">
				<img src="/5.0/assets/img/logo-on-top.png">
			</div>
			<div class="inner clearfix">
				<div id="sidebar">
					<a class="link-apidocs btn btn-primary" href="../../api">API Docs</a>
					<div class="panel panel-primary">
						<div class="panel-heading">
							<h3 class="panel-title">Outline</h3>
						</div>
						<div class="panel-body">
							<ul class="outline">
								<li class="level2"><a href="#基本 api">基本 api</a></li><li class="level3"><a href="#Class">Class</a></li><li class="level3"><a href="#Methods">Methods</a></li><li class="level2"><a href="#浏览器端使用">浏览器端使用</a></li><li class="level3"><a href="#载入 kissy">载入 kissy</a></li><li class="level3"><a href="#未预编译">未预编译</a></li><li class="level3"><a href="#预编译">预编译</a></li><li class="level2"><a href="#node 下使用">node 下使用</a></li><li class="level2"><a href="#语法">语法</a></li><li class="level3"><a href="#基本类型">基本类型</a></li><li class="level3"><a href="#map">map</a></li><li class="level3"><a href="#array">array</a></li><li class="level3"><a href="#转义">转义</a></li><li class="level3"><a href="#注释">注释</a></li><li class="level3"><a href="#变量渲染">变量渲染</a></li><li class="level3"><a href="#根数据访问">根数据访问</a></li><li class="level3"><a href="#支持变量属性获取">支持变量属性获取</a></li><li class="level3"><a href="#调用变量方法">调用变量方法</a></li><li class="level3"><a href="#变量运算">变量运算</a></li><li class="level3"><a href="#比较操作">比较操作</a></li><li class="level3"><a href="#逻辑操作">逻辑操作</a></li><li class="level3"><a href="#循环">循环</a></li><li class="level3"><a href="#范围循环">范围循环</a></li><li class="level3"><a href="#设置操作">设置操作</a></li><li class="level3"><a href="#宏">宏</a></li><li class="level3"><a href="#包含操作">包含操作</a></li><li class="level3"><a href="#继承">继承</a></li><li class="level3"><a href="#自定义命令">自定义命令</a></li><li class="level3"><a href="#Buffer api">Buffer api</a></li><li class="level3"><a href="#Scope api">Scope api</a></li><li class="level2"><a href="#Reserved words">Reserved words</a></li>
							</ul>
						</div>
					</div>
					<div class="panel panel-primary ajax-load ">
						<div class="panel-heading">
							<h3 class="panel-title">Features</h3>
						</div>
						<div class="panel-body">
							<p><a href="../../guides/xtemplate/index.html">XTemplate基本介绍</a></p>
						</div>
					</div>
					<div class="panel panel-primary ajax-load hide">
						<div class="panel-heading">
							<h3 class="panel-title">Demos</h3>
						</div>
						<div class="panel-body">
							
						</div>
					</div>
				</div>
				<div id="main-content">
					<h1 id="XTemplate基本介绍">XTemplate基本介绍</h1><h2 id="基本 api">基本 api</h2><h3 id="Class">Class</h3><p>XTemplate/XTemplateRuntime</p>
<p>构造器参数</p>
<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th style="width: 100px;">name</th>
        <th style="width: 50px;">type</th>
        <th>description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>content</td>
        <td>String</td>
        <td>模板字符串</td>
    </tr>
    <tr>
            <td>config</td>
            <td>Object</td>
            <td>
            对象属性含义：
            <table class="table table-bordered table-striped">
                    <thead>
                    <tr>
                        <th style="width: 100px;">name</th>
                        <th style="width: 50px;">type</th>
                        <th>description</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>name</td>
                        <td>String</td>
                        <td>模板名字，用于编译时报错</td>
                    </tr>
                    <tr>
                        <td>commands</td>
                        <td>Object</td>
                        <td>命令定义，详见下文</td>
                        </tr>
                    </tbody>
                </table></td>
        </tr>
    </tbody>
</table>


<h3 id="Methods">Methods</h3><pre><code class="lang-javascript"><span class="hljs-built_in">String</span> render(data:<span class="hljs-built_in">Object</span>, callback:<span class="hljs-built_in">Function</span>) <span class="hljs-comment">// 渲染数据，参数含义如下</span>
</code></pre>
<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th style="width: 100px;">name</th>
        <th style="width: 50px;">type</th>
        <th>description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>data</td>
        <td>Object</td>
        <td>数据对象</td>
    </tr>
    <tr>
            <td>callback</td>
            <td>Function</td>
            <td>完毕回调，第一个参数为 error，第二个参数为渲染结果。如果不提供，同步命令下 render 返回渲染结果。</td>
        </tr>
    </tbody>
</table>



<h2 id="浏览器端使用">浏览器端使用</h2><h3 id="载入 kissy">载入 kissy</h3><pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">'http://g.tbcdn.cn/kissy/edge/2014.07.16/seed.js'</span> 

<span class="hljs-attribute">data-config</span>=<span class="hljs-value">'{combine:true}'</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
</code></pre>
<h3 id="未预编译">未预编译</h3><pre><code class="lang-javascript">KISSY.<span class="hljs-keyword">use</span>(<span class="hljs-string">'xtemplate'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(S,XTemplate)</span></span>{
  <span class="hljs-keyword">new</span> XTemplate(<span class="hljs-string">'{{x}}'</span>,{name: <span class="hljs-string">'x-tpl'</span>}).render({x:<span class="hljs-number">1</span>},<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error,z)</span></span>{
    <span class="hljs-comment">// z=&gt;1</span>
  });
})
</code></pre>
<h3 id="预编译">预编译</h3><pre><code>npm install kissy<span class="hljs-variable">@5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>-alpha.<span class="hljs-number">10</span> -g
kissy-xtemplate -p x/   <span class="hljs-regexp">//</span> x/ 为模板文件目录，模板后缀为 xtpl
</code></pre><p>命令参数列表</p>
<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th style="width: 100px;">name</th>
        <th style="width: 50px;">type</th>
        <th style="width: 50px;">default</th>
        <th>description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>-p</td>
        <td>String</td>
        <td></td>
        <td>directory of xtemplate files</td>
    </tr>
    <tr>
        <td>-o</td>
        <td>String</td>
        <td></td>
        <td>directory of generated template javascript files</td>
    </tr>
    <tr>
        <td>-s</td>
        <td>String</td>
        <td>xtpl</td>
        <td>file name suffix of xtemplate files</td>
    </tr>
    <tr>
        <td>-w</td>
        <td>Boolean</td>
        <td>false</td>
        <td>whether watch xtemplate file change</td>
    </tr>
    </tbody>
</table>



<pre><code class="lang-javascript">KISSY.<span class="hljs-keyword">use</span>(<span class="hljs-string">'xtemplate/runtime,a/b-xtpl'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(S,XTemplateRuntime,bXtpl)</span></span>{
  <span class="hljs-keyword">new</span> XTemplateRuntime(bXtpl).render({x:<span class="hljs-number">1</span>},<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error,z)</span></span>{
    <span class="hljs-comment">// z=&gt;1</span>
  });
})
</code></pre>
<h2 id="node 下使用">node 下使用</h2><p>安装:</p>
<pre><code>npm <span class="hljs-operator"><span class="hljs-keyword">install</span> xtpl</span>
</code></pre><p>express 下使用:</p>
<pre><code class="lang-javascript">app.<span class="hljs-keyword">set</span>(<span class="hljs-string">"view engine"</span>, <span class="hljs-string">"xtpl"</span>);
</code></pre>
<p>模板文件全部为 xtpl 后缀，目录规范和渲染同 express</p>
<h2 id="语法">语法</h2><h3 id="基本类型">基本类型</h3><p>支持 true false null undefined number string map array</p>
<h3 id="map">map</h3><p>值为基本类型</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">with</span></span>({
  <span class="hljs-variable">x</span>:2
})}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">x</span>}}</span><span class="xml">  // =&gt; 2
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">with</span></span>}}</span><span class="xml"></span>
</code></pre><h3 id="array">array</h3><p>元素项为基本类型</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>([1,2,4])}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">this</span>}}</span><span class="xml">  // =&gt; 1 2 4
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"></span>
</code></pre><h3 id="转义">转义</h3><h4 id="使用 {{%%}}">使用 {{%%}}</h4><pre><code><span class="xml"></span><span class="hljs-expression">{{%

{{<span class="hljs-variable">x</span>}}</span><span class="xml">

%}}  // =&gt; </span><span class="hljs-expression">{{<span class="hljs-variable">x</span>}}</span><span class="xml"></span>
</code></pre><h4 id="使用 \{{">使用 \{{</h4><pre><code><span class="xml">\</span><span class="hljs-expression">{{<span class="hljs-variable">a</span>}}</span><span class="xml">  // -&gt; </span><span class="hljs-expression">{{<span class="hljs-variable">a</span>}}</span><span class="xml"></span>
</code></pre><h4 id="angularjs">angularjs</h4><p>如果是 angularjs 的话，可以直接配置 angularjs 使用不同的标记</p>
<p><a href="http://stackoverflow.com/questions/13671701/angularjs-twig-conflict-with-double-curly-braces">http://stackoverflow.com/questions/13671701/angularjs-twig-conflict-with-double-curly-braces</a></p>
<h3 id="注释">注释</h3><pre><code><span class="xml"></span><span class="hljs-expression">{{! <span class="hljs-variable">zhu</span> <span class="hljs-variable">shi</span> }}</span><span class="xml"></span>
</code></pre><h3 id="变量渲染">变量渲染</h3><p>转义：</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">x</span>}}</span><span class="xml"></span>
</code></pre><p>非转义:</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{{<span class="hljs-variable">x</span>}}</span><span class="xml">}</span>
</code></pre><h3 id="根数据访问">根数据访问</h3><pre><code class="lang-javascript">var x = {<span class="hljs-property">name</span>:<span class="hljs-number">1</span>,arr:[{<span class="hljs-property">name</span>:<span class="hljs-number">2</span>}]}
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">arr</span>)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">root.name</span>}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">name</span>}}</span><span class="xml"> </span><span class="hljs-expression">{{! 12 }}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"></span>
</code></pre><h3 id="支持变量属性获取">支持变量属性获取</h3><pre><code class="lang-javascript"><span class="hljs-keyword">var</span> x = {
    y: <span class="hljs-number">1</span>
};
<span class="hljs-keyword">var</span> y = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">var</span> z = {
    q: <span class="hljs-number">1</span>
};
<span class="hljs-keyword">var</span> x = <span class="hljs-string">'q'</span>;
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">x.y</span>}}</span><span class="xml"> // 1
</span><span class="hljs-expression">{{<span class="hljs-variable">y</span>[1]}}</span><span class="xml"> // 2
</span><span class="hljs-expression">{{<span class="hljs-variable">z</span>[<span class="hljs-variable">x</span>]}}</span><span class="xml"> // 1</span>
</code></pre><h3 id="调用变量方法">调用变量方法</h3><p>注意：该用法会影响性能，推荐自定义命令</p>
<pre><code class="lang-javascript"><span class="hljs-attribute">var x </span>=<span class="hljs-string"> [1, 2, 3];</span>
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">x.slice</span>(1))}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">this</span>}}</span><span class="xml"> </span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"> // =&gt; 2 3</span>
</code></pre><h3 id="变量运算">变量运算</h3><p>支持 + - * / %</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">x</span>+<span class="hljs-variable">y</span>}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">x</span> + <span class="hljs-string">"1"</span>}}</span><span class="xml">
</span><span class="hljs-expression">{{ <span class="hljs-variable">y</span> <span class="hljs-variable">-</span> 1 }}</span><span class="xml"></span>
</code></pre><h3 id="比较操作">比较操作</h3><p>支持 if elseif else === !=== &gt; &gt;= &lt; &lt;=</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">if</span></span>( <span class="hljs-variable">x</span>===1 )}}</span><span class="xml">
1
</span><span class="hljs-expression">{{<span class="hljs-variable">elseif</span> (<span class="hljs-variable">x</span>===2)}}</span><span class="xml">
2
</span><span class="hljs-expression">{{<span class="hljs-variable"><span class="hljs-keyword">else</span></span>}}</span><span class="xml">
3
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">if</span></span>}}</span><span class="xml">

</span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">if</span> </span>( (<span class="hljs-variable">x</span>+1) &gt; 2 )}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">if</span></span>}}</span><span class="xml"></span>
</code></pre><h3 id="逻辑操作">逻辑操作</h3><p>支持 || &amp;&amp;</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">if</span></span>(<span class="hljs-variable">x</span>&gt;1 &amp;&amp; <span class="hljs-variable">y</span>&lt;2)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">if</span></span>}}</span><span class="xml"></span>
</code></pre><pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">if</span></span>(!<span class="hljs-variable">x</span>)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">if</span></span>}}</span><span class="xml"></span>
</code></pre><h3 id="循环">循环</h3><p>可以对数组或对象进行循环操作，默认获取循环对象值为 {{this}}，键为 {{xindex}} , 也可以指定.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> x = [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>];
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">x</span>)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">xindex</span>}}</span><span class="xml"> </span><span class="hljs-expression">{{<span class="hljs-variable">this</span>}}</span><span class="xml"> // 0 a 1 b
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml">

</span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">x</span>,<span class="hljs-string">"value"</span>,<span class="hljs-string">"key"</span>)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">key</span>}}</span><span class="xml"> </span><span class="hljs-expression">{{<span class="hljs-variable">value</span>}}</span><span class="xml"> // 0 a 1 b
</span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"></span>
</code></pre><h3 id="范围循环">范围循环</h3><p>可以对 start 和 end(不包含) 范围内的数字进行循环</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">range</span>(0,3))}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">this</span>}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"> // 012
</span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">range</span>(3,0))}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">this</span>}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"> // 321
</span><span class="hljs-expression">{{<span class="hljs-begin-block">#<span class="hljs-keyword">each</span></span>(<span class="hljs-variable">range</span>(3,0,2))}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">this</span>}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-end-block">/<span class="hljs-keyword">each</span></span>}}</span><span class="xml"> // 31</span>
</code></pre><h3 id="设置操作">设置操作</h3><pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">set</span>(<span class="hljs-variable">x</span>=1)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">set</span>(<span class="hljs-variable">y</span>=3,<span class="hljs-variable">z</span>=2)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">x</span>}}</span><span class="xml"> // 1
</span><span class="hljs-expression">{{<span class="hljs-variable">y</span>+<span class="hljs-variable">z</span>}}</span><span class="xml"> // 5</span>
</code></pre><h3 id="宏">宏</h3><pre><code><span class="xml">// 声明
</span><span class="hljs-expression">{{<span class="hljs-begin-block">#macro</span>(<span class="hljs-string">"test"</span>,<span class="hljs-string">"param"</span> <span class="hljs-variable">default</span>=1)}}</span><span class="xml">param is </span><span class="hljs-expression">{{<span class="hljs-variable">param</span>}}</span><span class="xml"> </span><span class="hljs-expression">{{<span class="hljs-variable">default</span>}}</span><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-end-block">/macro</span>}}</span><span class="xml">

// 调用宏
</span><span class="hljs-expression">{{<span class="hljs-variable">macro</span>(<span class="hljs-string">"test"</span>,<span class="hljs-string">"2"</span>)}}</span><span class="xml"> // =&gt; param is 2 1

</span><span class="hljs-expression">{{<span class="hljs-variable">macro</span>(<span class="hljs-string">"test"</span>, <span class="hljs-string">"2"</span>, 2)}}</span><span class="xml"> // =&gt; param is 2 2</span>
</code></pre><h3 id="包含操作">包含操作</h3><p>x.xtpl</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">z</span>}}</span><span class="xml"></span>
</code></pre><p>y.xtpl</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">include</span>(<span class="hljs-string">"x"</span>)}}</span><span class="xml"></span>
</code></pre><h3 id="继承">继承</h3><p>layout.xtpl</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-doctype">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">meta</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"charset"</span> <span class="hljs-attribute">content</span>=<span class="hljs-value">"utf-8"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span></span><span class="hljs-expression">{{<span class="hljs-variable">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span>
        </span><span class="hljs-expression">{{{<span class="hljs-variable">block</span> (<span class="hljs-string">"head"</span>)}}</span><span class="xml">} // 坑
    <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
        </span><span class="hljs-expression">{{{<span class="hljs-variable">include</span> (<span class="hljs-string">"./header"</span>)}}</span><span class="xml">}
        </span><span class="hljs-expression">{{{<span class="hljs-variable">block</span> (<span class="hljs-string">"body"</span>)}}</span><span class="xml">}  // 坑
        </span><span class="hljs-expression">{{{<span class="hljs-variable">include</span> (<span class="hljs-string">"./footer"</span>)}}</span><span class="xml">}
    <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></span>
</code></pre>
<p>index.xtpl</p>
<pre><code class="lang-html"><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">extend</span> (<span class="hljs-string">"./layout1"</span>)}}</span><span class="xml">

// 填
</span><span class="hljs-expression">{{<span class="hljs-begin-block">#block </span>(<span class="hljs-string">"head"</span>)}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/css"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"test.css"</span> <span class="hljs-attribute">rev</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span>/&gt;</span>
</span><span class="hljs-expression">{{<span class="hljs-end-block">/block</span>}}</span><span class="xml">

// 填
</span><span class="hljs-expression">{{<span class="hljs-begin-block">#block </span>(<span class="hljs-string">"body"</span>)}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span></span><span class="hljs-expression">{{<span class="hljs-variable">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
</span><span class="hljs-expression">{{<span class="hljs-end-block">/block</span>}}</span><span class="xml"></span>
</code></pre>
<h3 id="自定义命令">自定义命令</h3><h4 id="nodejs 全局命令">nodejs 全局命令</h4><p>同步调用行内：</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> xtpl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xtpl'</span>);
xtpl.XTemplate.addCommand(<span class="hljs-string">'xInline'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(scope, option)</span></span>{
  <span class="hljs-keyword">return</span> option.params[<span class="hljs-number">0</span>]+<span class="hljs-string">'1'</span>;
});
</code></pre>
<p>此时模板中可通过 {{}} 来转义命令返回的内容.</p>
<p>或使用 buffer (详见下面 Buffer api)</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> xtpl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xtpl'</span>);
xtpl.XTemplate.addCommand(<span class="hljs-string">'xInline'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(scope, option, buffer)</span></span>{
  <span class="hljs-keyword">return</span> buffer.write(option.params[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>);
});
</code></pre>
<p>此时模板不能控制命令返回内容是否转义.</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">xInline</span>(1)}}</span><span class="xml"> // =&gt; 2</span>
</code></pre><p>同步调用块级：</p>
<pre><code class="lang-javascript">var xtpl = require(<span class="hljs-string">'xtpl'</span>);
xtpl.XTemplate.addCommand(<span class="hljs-string">'xBlock'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(scope, option, buffer)</span>{</span>
  <span class="hljs-keyword">return</span> option.fn(scope, <span class="hljs-keyword">buffer</span>).<span class="hljs-keyword">write</span>(option.params[<span class="hljs-number">0</span>]); //option.fn(scope, <span class="hljs-keyword">buffer</span>)返回的是块级标签内的内容，例如下面例子的 <span class="hljs-string">'2'</span>
});
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#xBlock</span>(1)}}</span><span class="xml">
2
</span><span class="hljs-expression">{{<span class="hljs-end-block">/xBlock</span>}}</span><span class="xml">
// =&gt; 21</span>
</code></pre><p>异步调用行内</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> xtpl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xtpl'</span>);
xtpl.XTemplate.addCommand(<span class="hljs-string">'xInline'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(scope, option,buffer)</span></span>{
  buffer = buffer.async(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(newBuffer)</span></span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        newBuffer.write(option.params[<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>).end();
    },<span class="hljs-number">10</span>);
  });
  <span class="hljs-keyword">return</span> buffer;
});
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">xInline</span>(1)}}</span><span class="xml"> // =&gt; 2</span>
</code></pre><p>异步调用块级：</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> xtpl = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xtpl'</span>);
xtpl.XTemplate.addCommand(<span class="hljs-string">'xInline'</span>,<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(scope, option,buffer)</span></span>{
  buffer = buffer.async(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(newBuffer)</span></span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">var</span> newScope = xtpl.XTemplate.Scope({ret:<span class="hljs-number">2</span>});
        newScope.setParent(scope);
        option.fn(newScope, newBuffer);
    },<span class="hljs-number">10</span>);
  });
  buffer.write(option.params[<span class="hljs-number">0</span>]);
  <span class="hljs-keyword">return</span> buffer;
});
</code></pre>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-begin-block">#xBlock</span>(1)}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-variable">ret</span>}}</span><span class="xml">
</span><span class="hljs-expression">{{<span class="hljs-end-block">/xBlock</span>}}</span><span class="xml">
// =&gt; 21</span>
</code></pre><h4 id="浏览器命令">浏览器命令</h4><p>全局：</p>
<pre><code class="lang-javascript">KISSY.use(<span class="hljs-string">'xtemplate/runtime'</span>,<span class="hljs-keyword">function</span>(S,XTemplate){
    XTemplate.addCommand(<span class="hljs-keyword">...</span>) // 同 nodejs
});
</code></pre>
<p>局部：</p>
<p>x-xtpl.html:</p>
<pre><code><span class="xml"></span><span class="hljs-expression">{{<span class="hljs-variable">x</span>()}}</span><span class="xml"></span>
</code></pre><pre><code class="lang-javascript">KISSY.use(<span class="hljs-string">'xtemplate/runtime, x-xtpl'</span>,<span class="hljs-keyword">function</span>(S,XTemplate,x){
    new XTemplate(x, {
        commands:{
            x:<span class="hljs-keyword">function</span>(){
                // <span class="hljs-keyword">...</span> 同 node
            }
        }
    })<span class="hljs-keyword">...</span>
});
</code></pre>
<h3 id="Buffer api">Buffer api</h3><h4 id="Methods">Methods</h4><pre><code class="lang-javascript">Buffer write(data:<span class="hljs-built_in">String</span>, <span class="hljs-built_in">escape</span>:<span class="hljs-built_in">Boolean</span>) <span class="hljs-comment">// 写数据到缓冲区</span>
</code></pre>
<table class="table table-bordered table-striped">
    <thead>
    <tr>
        <th style="width: 100px;">name</th>
        <th style="width: 50px;">type</th>
        <th>description</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>data</td>
        <td>String</td>
        <td>将要写到缓冲区的字符串</td>
    </tr>
    <tr>
            <td>escape</td>
            <td>Boolean</td>
            <td>是否转义</td>
        </tr>
    </tbody>
</table>



<pre><code class="lang-javascript">Buffer async(fn:<span class="hljs-built_in">Function</span>) <span class="hljs-comment">// 产生新的异步缓冲区，新的缓冲区为 fn 回调函数的第一个参数</span>

Buffer end(data, <span class="hljs-built_in">escape</span>) <span class="hljs-comment">// 参数含义同 write 函数。 标志缓冲区数据填充完毕，用于通知异步缓冲区的结束。</span>

Buffer error(reason) <span class="hljs-comment">// 触发 render 异步回调为失败。 reason 为回调的第一个参数.</span>
</code></pre>
<h3 id="Scope api">Scope api</h3><h4 id="Members">Members</h4><pre><code class="lang-javascript"><span class="hljs-keyword">parent</span> <span class="hljs-comment">// 上级作用域</span>

root <span class="hljs-comment">// 顶层作用域</span>
</code></pre>
<h4 id="Methods">Methods</h4><pre><code class="lang-javascript"><span class="hljs-keyword">void</span> setParent(scope: Scope) <span class="hljs-comment">// 设置当前作用域的上级作用域</span>

<span class="hljs-keyword">void</span> setData(data) <span class="hljs-comment">// 设置当前作用域内数据</span>

<span class="hljs-keyword">var</span> getData() <span class="hljs-comment">// 获取当前作用域内数据</span>

<span class="hljs-keyword">void</span> <span class="hljs-keyword">set</span>(name, <span class="hljs-keyword">value</span>) <span class="hljs-comment">// 设置当前作用域内附属数据</span>

<span class="hljs-keyword">void</span> <span class="hljs-keyword">get</span>(name) <span class="hljs-comment">// 获取当前作用域内数据值（包括附属数据）</span>
</code></pre>
<h2 id="Reserved words">Reserved words</h2><p><strong>Xtemplate内置以下命令，请避免重复定义同名命令</strong></p>
<table class="table table-bordered table-striped">
    <tr>
        <td>block</td><td>debugger</td><td>each</td><td>extend</td>
    </tr>
    <tr>
        <td>if</td><td>include</td><td>marco</td><td>parse</td>
    </tr>
    <tr>
        <td>range</td><td>set</td><td>with</td><td></td>
    </tr>
</table>
				</div>
			</div>
		</div>
	</div>
	<div class="footer">
		<div class="wrap-disqus">
	<div id="disqus_thread"></div>
</div>
<script>
    if((window.location.hostname.indexOf("kissyui.com")!=-1 )&& window.localStorage.getItem("kissy-commment")!="0"){
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kissy-docs'; // required: replace example with your forum shortname

    // The following are highly recommended additional parameters. Remove the slashes in front to use.
     //var disqus_identifier = '/anim';
     //var disqus_url = window.location;

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    }
</script>
<div class="other-page">
	<div class="wrap">
		<div class="content">
			<p>@2010 - 2112 KISSY UI LIBARAY</p>
		</div>
	</div>
</div>
	</div>
</body>
</html>